## Visual formatting model


[`9 Visual formatting model`](https://www.w3.org/TR/2011/REC-CSS2-20110607/visuren.html) / [`10 Visual formatting model details`](https://www.w3.org/TR/2011/REC-CSS2-20110607/visudet.html#q10.0)

定位机制: 常规流 / 浮动 / 定位 / 弹性盒子 / 栅格

**属性**

* 调整元素显示方式: `display`
* 宽度: `width`
* 高度: `height`

## 重要概念

* 常规流动 / 非置换元素 / 置换元素 / 跟元素/ 块级框 / 行内框 / 行内块级框  / 容纳块
* 外边距可以设为负值


## 块级框


**横向格式化**

1. 七个横向属性之和始终等于父元素的 `width`

只有三个属性的值能为 `auto`: 宽度、左右外边距

> * `零个`: 如果把这三个属性都设为 `auto` 之外的值，用CSS术语来说就是过约束了，那么 `margin-right`将呗强制设为 `auto`
> * `一个`： 如果把其中一个设为 auto, 另两个设为具体的值，那么设为 `auto` 的那么个属性的具体长度要能满足元素框的宽度等于父元素的宽度
> * `两个`:  如果左右外边距都明确设为 `auto`, 那么`width`的值是满足总宽度的任何值。元素在父元素内居中显示
> * `两个`： 某一外边距和 `width` 设为 `auto`。此时设为`auto`的那个外边距等于零
* `三个`: 两侧的外边距被设为零， 而 `width` 则有要多宽有多宽


**纵向格式化**

* 元素的内容决定元素的默认高度
* 如果元素的内容比框体高，用户代理的具体行为取决于`overflow` 属性
* 七个属性的值加在一起必须等于块级框的容纳块的高度
* 默认的高度是从最上边那个块级子代元素上边框外侧到最下边那个块级子代元素的下边框外侧之间的距离。

只有三个可以设为 `auto`： 高度、上下外边距

> * 下内边距和外边距必须设置具体的值，否则取默认值零。
> * 如果未明确声明容纳块的高度，那么百分数高度将被重置为`auto`


## 行内元素

* 匿名文本 / 字体框 / 内容区 / 行距 / 行内框 / 行框
* 内边距、边框和外边距在对应的方框上没有纵向效果

> * `line-height` 属性指行的基线之间的距离，与字号无关，决定着元素所在方框的高度是增还是减。
> * 文本行中的每个元素构成一个 `内容区(content area)` , 其高度由字体的高度决定。随内容区出现的是一个 `行内框(inline box)`, 如果不考虑其他因素，其高度与内容区完全相等。
> * 元素的行距等于 `font-size` 的计算结果减去 `line-height` 的计算结果。行距分为两半，分别放到内容区的上部和下部。算上行距得到的就是元素的行内框
> * `行框(line box)` 恰好包围最高那个行内框的顶端和最低那个行内框的底端。




* 行高: `lien-height`
* 纵向对齐: `vertical-align`

默认基线对齐, 如果目标元素没有基线，元素的底端与父元素的基线对齐.


## 行内块级元素

## 浮动元素

*  浮动元素四周的外边距不折叠
*  如果浮动的是非置换元素，要为元素设定宽度.
*  不管元素是什么类型，浮动后得到都是块级框.

**规则**

1. 浮动元素的左（或右）外边界不能超过容纳块的左（或右边界）
2. 前面的元素向左浮动，后面的浮动元素的左外边界必定在前一个元素右外边界的右侧，除非后一个元素的顶边在前一个元素的底边以下。
3. 左浮动元素的右外边界不能在右浮动元素元的左外边界的右侧。
4. 浮动元素的顶边不能比父元素的内顶边高.
5. 浮动元素的顶边不能比前方任何一个浮动元素或块级元素的顶边高。
6. 浮动元素的顶边不能高于文档源码中出现在浮动元素之前的元素生成的框体所在行框的顶边。
7. 左浮动元素的左边如果还有一个向左浮动的元素，那么它的右外边界不能在容纳块右边界的右侧。
8. 浮动元素必须放在尽可能高的位置上。
9. 左浮动元素必须尽量向左移动。

**浮动元素与内容重叠**

* 浮动元素的后代也浮动时，将扩大范围, 涵盖浮动的后代元素
* 行内框与浮动元素重叠时，其边框、背景和内容都在浮动元素之上渲染。
* 块级框与浮动元素重叠时，其边框和背景在浮动元素背后渲染，而内容在元素之上渲染。

**清除浮动**

*  clear 起作用的方式增加元素的上外边距，把元素移到浮动元素的下方。
*  间距时为了把元素向下移动，确保显示在浮动元素下方而在元素上方的外边距上方增加的额外空白

### 定位

* 定位类型: `position`
* 偏移属性: `top` / `right` / `bottom` / `left`
* `min-width` / `min-height`
* `max-width` /`max-height`

> * 如果值是`relative` 或 `static` 其容纳块有最近的块级
> * 如果值是 `absolute` 起容纳块是值不是 `static`的祖辈元素


### 溢出

* `overflow`
* `visibility`
* `z-index`



**参考资料**

* [深入理解 CSS 中的行高与基线](https://yq.aliyun.com/articles/330933)
* [详解CSS行高](https://sinaad.github.io/xfe/2016/04/15/css-line-height/)
* [CSS深入理解vertical-align和line-height的基友关系](https://www.zhangxinxu.com/wordpress/2015/08/css-deep-understand-vertical-align-and-line-height/)

